---

## amnesia威胁报告
目前针对物联网设备的恶意软件越来越普遍，一般来说针对物联网设备的攻击分为两个方面：**一是**通过自动化工具使用密码字典尝试批量猜解物联网设备的管理员帐号及密码，导致攻击者可以轻易访问物联网设备(物联网设备被攻击者控制)；**二是**因为物联网设备存在安全漏洞，攻击者利用漏洞来对设备进行攻击，达到控制设备的目的。
**被控制的物联网设备往往会被攻击者集中起来，组建僵尸网络，从而发起DDoS(分布式拒绝服务攻击)攻击。**

近日，一个Linux僵尸网络Tsunami的新变种——名为Amnesia的恶意软件席卷网络。本文主要从爆发时间线、传播原理、对抗办法几个方面进行分析和阐述。

#### 一、主要爆发时间线

2016年3月，一个名为Rotem Kerner的安全研究员发现，某款DVR(数字视频录像机)存在远程代码利用漏洞，黑客可以利用漏洞远程悄无声息地在设备上执行命令并进行完全掌控，随后他将其发现的漏洞上报了DVR厂商，但是未得到任何回应。

心怀不轨的黑客们发现了这座潜在的“金矿”，名为Amnesia的恶魔便悄然诞生。

Amnesia是Tsunami僵尸网络的变种，其父辈Tsunami是一种下载程序/IRC僵尸程序后门，被网络犯罪分子用来发动DDoS攻击。

Amnesia即为通过利用漏洞来对物联网设备进 行攻击的恶意软件，Amnesia也是首个采用虚拟机检测技术来躲避恶意软件分析沙箱的Linux嵌入式恶意软件。
Amnesia僵尸网络允许攻击者利用 远程代码执行漏洞对未打补丁的数字视频录像机设备发起攻击。其中全球大概70多家厂商受到影响，这些厂商均使用了由TVT Digital（深圳同为）生产的设备。根据目前的扫描数据，全球有227000台设备受此漏洞影响，主要受影响的国家和地区包括：中国台湾、美国、以色 列、土耳其和印度。


#### 二、网络图
本次发现的Amnesia僵尸网络运行在PowerPC架构上，首先攻击者通过暴力猜解或者其他手段感染DVR设备，使Amnesia恶意代码在 DVR上开始运行，当Amnesia运行后，它会连接远程C&C，并根据控制指令中指定的IP范围扫描网络中的其他DVR设备进行传播。

Amnesia是首个采用虚拟机检测技术来躲避恶意软件分析沙箱的Linux嵌入式恶意代码。针对Windows或安卓的恶意软件常常会采用虚拟机 检测技术来躲避沙箱环境的分析，然而该技术在Linux嵌入式系统上却很少采用。当僵尸网络Amnesia发现自身运行于VirtualBox、 VMware或QEMU虚拟机中，它将删除系统中的所有文件来阻碍恶意软件分析沙箱的正常运行。 

Linux系统中的/sys/class/dmi/id目录里存放了主机的相关硬件信息，包括产品信息、主板信息、Bios信息等，Amnesia就是通过读取该目录中的文件获取当前主机的硬件信息。当Amnesia运行时会读取/sys/class/dmi/id/product_name和/sys/class/dmi/id/sys_vendor文件，并匹配其中是否包含关键字“VirtualBox”、“VMware”和“QEMU”来判断当前目标系统是否为虚拟机。 

当检测到当前主机为虚拟机时，Amnesia将开启自我删除，并删除Linux根目录、当前用户主目录、工作目录，这些删除操作相当于擦除整个Linux系统，会对整个系统造成损害

##### 2.3 对抗机制

2.4 供给机制

2.5 其他技术要点

2.6 支持平台

#### 三、影响

3.1 涉及设备

3.2 涉及范围

3.3 持续时间

3.4 国内外攻击情况（域名、服务器等）

#### 四、技术分析及预测

4.1 
